<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
</head>
<body>
<h1>Picture Feed</h1>
<input type="button" value="Camera">

<script src="phonegap.js"></script>
<script src="jquery-2.0.3.min.js"></script>
<script type="text/javascript">
  var serverURL = "http://squares.roundporch.com";

  function upload(imageURI) {
    var ft = new FileTransfer();
    var options = new FileUploadOptions();

    options.fileKey = "file";
    options.fileName = 'filename.jpg'; // We will use the name auto-generated by Node at the server side.
    options.mimeType = "image/jpeg";
    options.chunkedMode = false;
    options.params = { // Whatever you populate options.params with, will be available in req.body at the server-side.
      "description": "Uploaded from my phone"
    };

    ft.upload(imageURI, serverURL + "/upload.php",
      function (e) {
        alert('success');
      },
      function (e) {
        alert("failed");
      }, options);
  }

  // Take a picture using the camera or select one from the library
  function takePicture() {
    var options = {
      quality: 45,
      targetWidth: 1000,
      targetHeight: 1000,
      destinationType: Camera.DestinationType.DATA_URL,
      encodingType: Camera.EncodingType.JPEG,
      sourceType: Camera.PictureSourceType.CAMERA
    };

    navigator.camera.getPicture(
      function (imageURI) {
        upload(imageURI);
        alert('uploaed');
      },
      function (message) {
        alert('failed');
        // We typically get here because the use canceled the photo operation. Fail silently.
      }, options);
  }

  $('input').on('click', takePicture);
</script>
</body>
</html>
